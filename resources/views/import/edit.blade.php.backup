@extends('layouts.app')
@section('title', 'Edit Pemberitahuan Impor')

@section('content')
    <div class="bg-white rounded-2xl shadow p-6">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-xl font-semibold">Edit Pemberitahuan Impor #{{ $importNotification->id }}</h1>
            <a href="{{ route('import.index') }}" class="px-3 py-2 border rounded text-sm">Kembali</a>
        </div>

        <form method="POST" action="{{ route('import.update', $importNotification) }}" class="space-y-6">
            @csrf
            @method('PUT')

            <!-- Header Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Header</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Nomor Aju</label>
                        <input type="text" name="header[nomor_aju]"
                            value="{{ old('header.nomor_aju', $importNotification->header['nomor_aju'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Nomor Dokumen</label>
                        <input type="text" name="header[nomor_dokumen]"
                            value="{{ old('header.nomor_dokumen', $importNotification->header['nomor_dokumen'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Tanggal</label>
                        <input type="date" name="header[tanggal]"
                            value="{{ old('header.tanggal', $importNotification->header['tanggal'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Kantor Pabean</label>
                        <select name="header[kantor_pabean]" class="w-full border rounded px-3 py-2" required>
                            <option value="">Pilih Kantor Pabean</option>
                            @foreach (config('import.kantor_pabean') as $key => $value)
                                <option value="{{ $key }}"
                                    {{ old('header.kantor_pabean', $importNotification->header['kantor_pabean'] ?? '') == $key ? 'selected' : '' }}>
                                    {{ $value }}</option>
                            @endforeach
                        </select>
                    </div>
                </div>
            </div>

            <!-- Entitas Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Entitas</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Nama Importir</label>
                        <input type="text" name="entitas[importir_nama]"
                            value="{{ old('entitas.importir_nama', $importNotification->entitas['importir_nama'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">NPWP Importir</label>
                        <input type="text" name="entitas[importir_npwp]"
                            value="{{ old('entitas.importir_npwp', $importNotification->entitas['importir_npwp'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium mb-1">Alamat Importir</label>
                        <textarea name="entitas[importir_alamat]" class="w-full border rounded px-3 py-2" rows="3" required>{{ old('entitas.importir_alamat', $importNotification->entitas['importir_alamat'] ?? '') }}</textarea>
                    </div>
                </div>
            </div>

            <!-- Dokumen Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Dokumen</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Jenis Dokumen</label>
                        <select name="dokumen[jenis_dokumen]" class="w-full border rounded px-3 py-2" required>
                            <option value="">Pilih Jenis Dokumen</option>
                            @foreach (config('import.jenis_dokumen') as $key => $value)
                                <option value="{{ $key }}"
                                    {{ old('dokumen.jenis_dokumen', $importNotification->dokumen['jenis_dokumen'] ?? '') == $key ? 'selected' : '' }}>
                                    {{ $value }}</option>
                            @endforeach
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Nomor Dokumen</label>
                        <input type="text" name="dokumen[nomor_dokumen]"
                            value="{{ old('dokumen.nomor_dokumen', $importNotification->dokumen['nomor_dokumen'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Pengangkut Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Pengangkut</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Nama Pengangkut</label>
                        <input type="text" name="pengangkut[nama]"
                            value="{{ old('pengangkut.nama', $importNotification->pengangkut['nama'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Nomor Pengangkut</label>
                        <input type="text" name="pengangkut[nomor]"
                            value="{{ old('pengangkut.nomor', $importNotification->pengangkut['nomor'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Kemasan Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Kemasan</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Jenis Kemasan</label>
                        <input type="text" name="kemasan[jenis]"
                            value="{{ old('kemasan.jenis', $importNotification->kemasan['jenis'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Jumlah</label>
                        <input type="number" name="kemasan[jumlah]"
                            value="{{ old('kemasan.jumlah', $importNotification->kemasan['jumlah'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Transaksi Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Transaksi</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Jenis Transaksi</label>
                        <input type="text" name="transaksi[jenis]"
                            value="{{ old('transaksi.jenis', $importNotification->transaksi['jenis'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Nilai</label>
                        <input type="number" step="0.01" name="transaksi[nilai]"
                            value="{{ old('transaksi.nilai', $importNotification->transaksi['nilai'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Barang Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Barang</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Nama Barang</label>
                        <input type="text" name="barang[nama]"
                            value="{{ old('barang.nama', $importNotification->barang['nama'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">HS Code</label>
                        <input type="text" name="barang[hs_code]"
                            value="{{ old('barang.hs_code', $importNotification->barang['hs_code'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Jumlah</label>
                        <input type="number" name="barang[jumlah]"
                            value="{{ old('barang.jumlah', $importNotification->barang['jumlah'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Satuan</label>
                        <input type="text" name="barang[satuan]"
                            value="{{ old('barang.satuan', $importNotification->barang['satuan'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Pungutan Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Pungutan</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">BM (Bea Masuk)</label>
                        <input type="number" step="0.01" name="pungutan[bm]"
                            value="{{ old('pungutan.bm', $importNotification->pungutan['bm'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">PPN (PPN Impor)</label>
                        <input type="number" step="0.01" name="pungutan[ppn]"
                            value="{{ old('pungutan.ppn', $importNotification->pungutan['ppn'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">PPnBM</label>
                        <input type="number" step="0.01" name="pungutan[ppnbm]"
                            value="{{ old('pungutan.ppnbm', $importNotification->pungutan['ppnbm'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">PPH</label>
                        <input type="number" step="0.01" name="pungutan[pph]"
                            value="{{ old('pungutan.pph', $importNotification->pungutan['pph'] ?? '') }}"
                            class="w-full border rounded px-3 py-2" required>
                    </div>
                </div>
            </div>

            <!-- Pernyataan Section -->
            <div class="border rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">Pernyataan</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Pernyataan</label>
                        <textarea name="pernyataan[teks]" class="w-full border rounded px-3 py-2" rows="4" required>{{ old('pernyataan.teks', $importNotification->pernyataan['teks'] ?? '') }}</textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Status</label>
                        <select name="status" class="w-full border rounded px-3 py-2" required>
                            <option value="draft"
                                {{ old('status', $importNotification->status) == 'draft' ? 'selected' : '' }}>Draft
                            </option>
                            <option value="submitted"
                                {{ old('status', $importNotification->status) == 'submitted' ? 'selected' : '' }}>Submitted
                            </option>
                            <option value="approved"
                                {{ old('status', $importNotification->status) == 'approved' ? 'selected' : '' }}>Approved
                            </option>
                            <option value="rejected"
                                {{ old('status', $importNotification->status) == 'rejected' ? 'selected' : '' }}>Rejected
                            </option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-2">
                <a href="{{ route('import.index') }}" class="px-4 py-2 border rounded">Batal</a>
                <button type="submit" class="px-4 py-2 bg-black text-white rounded">Update</button>
            </div>
        </form>
    </div>
@endsection
